<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEAGUE DATA LOOKUP</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <main>
        <section class="hero">
            <img src="profile-photo.png" alt="Angel Ojeda" class="profile-photo" style="width:180px;height:180px;">
            <h1>Angel Ojeda</h1>
            <p class="tagline">Cybersecurity⚔️AWS Enthusiast⚔️Gamer</p>
            <a href="https://builder.aws.com/community/@makanaki" target="_blank" class="aws-link">AWS Builder Center
            Profile</a>
        </section>

        <!-- LEAGUE DATA LOOKUP SECTION -->
        <section class="league-lookup">
            <h3>League Data Lookup</h3>
            <p>Enter a Riot ID to see their level and top champions!</p>

            <!-- Lookup message container for success/error messages -->
            <div id="lookup-message" class="lookup-message" style="display: none;"></div>

            <div class="lookup-form-container">
                <!-- Riot ID lookup form -->
                <div class="form-group">
                    <label for="summoner-name">Riot ID</label>
                    <input type="text" id="summoner-name" name="summoner-name"
                        placeholder="GameName#TAG (e.g., Hide on bush#KR1)" required>
                    <small style="color: #687078; display: block; margin-top: 4px;">Format: GameName#TAG</small>
                </div>
                <div class="form-group">
                    <label for="region">Region</label>
                    <select id="region" name="region">
                        <option value="na1">North America</option>
                        <option value="euw1">Europe West</option>
                        <option value="eun1">Europe Nordic & East</option>
                        <option value="kr">Korea</option>
                        <option value="br1">Brazil</option>
                        <option value="la1">Latin America North</option>
                        <option value="la2">Latin America South</option>
                        <option value="oc1">Oceania</option>
                        <option value="tr1">Turkey</option>
                        <option value="ru">Russia</option>
                        <option value="jp1">Japan</option>
                    </select>
                </div>
                <!-- Lookup submit button -->
                <button type="button" id="lookup-btn" class="lookup-submit-btn">Look Up Summoner</button>
            </div>

            <!-- Results display area -->
            <div id="summoner-results" class="summoner-results" style="display: none;">
                <h4>Summoner Info</h4>
                <div id="summoner-info"></div>
                <div id="champion-mastery"></div>
            </div>
        </section>
        <!-- END LEAGUE DATA LOOKUP SECTION -->
    </main>

    <footer>
        <p>&copy; 2025 Angel Ojeda. Built with ❤️ on AWS</p>
    </footer>

    <!-- Contact form JavaScript -->
    <script src="script.js"></script>
    <script>
        // League Data Lookup - Calls Riot API via Lambda
        const RIOT_API_URL = 'https://sfyfgbxxhiz5bzxmfto5vy6zbu0yqstx.lambda-url.us-east-1.on.aws/'; // Replace with your Function URL 

        document.addEventListener('DOMContentLoaded', function () {
            const lookupBtn = document.getElementById('lookup-btn');
            const summonerNameInput = document.getElementById('summoner-name');
            const regionSelect = document.getElementById('region');

            lookupBtn.addEventListener('click', async function () {
                const summonerName = summonerNameInput.value.trim();
                const region = regionSelect.value;
                const messageDiv = document.getElementById('lookup-message');
                const resultsDiv = document.getElementById('summoner-results');

                if (!summonerName) {
                    showMessage('Please enter a Riot ID', 'error');
                    return;
                }

                if (!summonerName.includes('#')) {
                    showMessage('Please use Riot ID format: GameName#TAG', 'error');
                    return;
                }

                // Show loading state
                lookupBtn.textContent = 'Looking up...';
                lookupBtn.disabled = true;
                messageDiv.style.display = 'none';
                resultsDiv.style.display = 'none';

                try {
                    const response = await fetch(RIOT_API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            summonerName: summonerName,
                            region: region
                        })
                    });

                    const data = await response.json();

                    if (response.ok) {
                        displaySummonerData(data);
                        showMessage('Summoner found!', 'success');
                    } else {
                        showMessage(data.error || 'Failed to fetch summoner data', 'error');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showMessage('Network error. Please try again.', 'error');
                }

                // Reset button
                lookupBtn.textContent = 'Look Up Summoner';
                lookupBtn.disabled = false;
            });

            // Enter key support
            summonerNameInput.addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    lookupBtn.click();
                }
            });
        });

        async function displaySummonerData(data) {
            const resultsDiv = document.getElementById('summoner-results');
            const summonerInfo = document.getElementById('summoner-info');
            const championMastery = document.getElementById('champion-mastery');

            // Display summoner info
            summonerInfo.innerHTML = `
            <div class="summoner-card">
                <h5>${data.summoner.name}</h5>
                <p>Level: ${data.summoner.level}</p>
            </div>
        `;

            try {
                const response = await fetch('championship.json');
                const championshipData = await response.json();

                if (data.topChampions && data.topChampions.length > 0) {
                    const champions = Object.values(championshipData.data); // all champions as array

                    // Build the HTML for each top champion
                    const championsHtml = data.topChampions.map(champ => {
                        const championInfo = champions.find(c => c.key == champ.championId);
                        const champName = championInfo ? championInfo.name : 'Unknown Champion';
                        const champImg = championInfo
                            ? `https://ddragon.leagueoflegends.com/cdn/${championshipData.version}/img/champion/${championInfo.image.full}`
                            : '';

                        return `
                        <div class="champion-card">
                            <img src="${champImg}" alt="${champName}" class="champion-icon">
                            <p><strong>${champName}</strong></p>
                            <p>Mastery Level: ${champ.championLevel}</p>
                            <p>Mastery Points: ${champ.championPoints.toLocaleString()}</p>
                        </div>
                    `;
                    }).join('');

                    championMastery.innerHTML = `
                    <h5>Top Champions</h5>
                    <div class="champions-grid">
                        ${championsHtml}
                    </div>
                `;
                } else {
                    championMastery.innerHTML = '<p>No champion mastery data found.</p>';
                }

                resultsDiv.style.display = 'block';
            } catch (error) {
                console.error('Error loading championship data:', error);
                championMastery.innerHTML = '<p>Error loading champion data.</p>';
            }
        }

        function showMessage(text, type) {
            const messageDiv = document.getElementById('lookup-message');
            messageDiv.textContent = text;
            messageDiv.className = `lookup-message ${type}`;
            messageDiv.style.display = 'block';

            // Auto-hide after 10 seconds
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 10000);
        }
    </script>
</body>

</html>